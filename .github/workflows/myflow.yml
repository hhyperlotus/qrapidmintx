name: ci
on:
  push:
  workflow_dispatch:
  schedule:
    - cron: "0 1,7,13,19 * * *"


jobs:
  myflow:
    runs-on: ubuntu-latest
    timeout-minutes: 340 

    steps:
    - name: Install CLI
      run: |
        curl -fsSL https://cli.nexus.xyz/ | sh
        echo "$HOME/.nexus/bin" >> $GITHUB_PATH

    - name: Start
      run: |
        set -e
        NODE_ID=37244068  # for qrapidmintx

        echo "ğŸš€ Starting (Node ID: $NODE_ID)"
        nexus-cli start --node-id "$NODE_ID" --max-threads 2 --headless &
        NEXUS_PID=$!

        echo "ğŸ•’ Current UTC time: $(date -u)"
        echo "â° Will run for exactly 4 hours (14400 seconds)"

        # Run for exactly 4 hours
        sleep 14400

        echo "ğŸ›‘ Stopping at $(date -u)"
        kill "$NEXUS_PID" || true
